<!DOCTYPE html>
<html>
<head>
    <title>现代前端开发 - 前端工程化</title>

    <meta charset="UTF-8"/>

    <meta content="text/html; charset=utf-8" http-equiv="Content-Type"/>

    <meta name="HandheldFriendly" content="true"/>

    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no"/>

    <meta name="apple-mobile-web-app-capable" content="yes"/>

    <meta name="apple-mobile-web-app-status-bar-style" content="black"/>

    <link href="../asset/gitbook/style.css" type="text/css" rel="stylesheet"/>
    <link href="../asset/gitbook/istyle.css" type="text/css" rel="stylesheet"/>

    <style type="text/css">
        
            span.md_line{margin-bottom:0.5em; display:block; line-height:1.89}
            .md_line br{ display: none;}
            
    </style>

    <script>
        var flowchat_options = {
            'x': 0, 'y': 0, 'line-width': 1, 'line-length': 50, 'text-margin': 10, 'font-size': 13,
            'font-color': '#3c3c3c', 'line-color': '#666666', 'element-color': '#666666', 'fill': 'transparent',
            'yes-text': 'yes', 'no-text': 'no', 'arrow-end': 'block', 'class': 'flowchart', 'scale': 1,
            'symbols': { 'start': {}, 'end': {}, 'condition': {}, 'inputoutput': {}, 'operation': {}, 'subroutine': {}}
        }
    </script>
    <script type="text/javascript" src="../asset/other/raphael-min.js"></script>
    <script type="text/javascript" src="../asset/other/flowchart.js"></script>
    <script type="text/javascript" src="../asset/other/echarts.min.js"></script>


</head>

<body>





<div data-basepath="/service/gitbook" class="book">
    <div class="book-summary">
        <ul class="summary">
            <li>
                <a href="../index.html">web-dev</a>
            </li>
            <li class="divider"></li>
            
                
                
    
    <li data-level="1" class="chapter" data-path="现代前端开发/index.html">
        
        
        <a href="#" ><b>1</b> 现代前端开发</a>
        
            
                    
                        <ul class="articles">
                            
                                
    
    <li data-level="1.1" class="chapter" data-path="现代前端开发/01-概述.html">
        
        
        <a href="../现代前端开发/01-概述.html" ><b>1.1</b> 现代前端开发 - 概述</a>
        
    </li>

                            
                                
    
    <li data-level="1.2" class="chapter active" data-path="现代前端开发/02-前端工程化.html">
        
        
        <a href="../现代前端开发/02-前端工程化.html" ><b>1.2</b> 现代前端开发 - 前端工程化</a>
        
    </li>

                            
                                
    
    <li data-level="1.3" class="chapter" data-path="现代前端开发/03-Webpack.html">
        
        
        <a href="../现代前端开发/03-Webpack.html" ><b>1.3</b> 现代前端开发 - Webpack</a>
        
    </li>

                            
                                
    
    <li data-level="1.4" class="chapter" data-path="现代前端开发/04-HTML5 & CSS5 & Flex & HTTP2 & Catch.html">
        
        
        <a href="../现代前端开发/04-HTML5 & CSS5 & Flex & HTTP2 & Catch.html" ><b>1.4</b> 现代前端开发 - HTML5 & CSS3 & Flex布局 & WebSocket & Catch & HTTP2</a>
        
    </li>

                            
                        </ul>
                    
                
        
    </li>

            
        </ul>

    </div>

    <div class="book-body">
        <div class="body-inner">

            <div class="book-header" role="navigation">
                <h1>
                    <a href="../index.html" > web-dev</a>
                </h1>
            </div>

            <div tabindex="-1" class="page-wrapper">
                <div class="page-inner">
                    <h2 class="post_title"> 现代前端开发 - 前端工程化 </h2>
                    <div class="post_body"> <h1 id="toc_0">前端工程化</h1>

<blockquote>

<p class="md_block">
    <span class="md_line">“软件工程”是一门研究如何系统化、规范化、数量化的开发和维护软件的学科</span>
</p>

</blockquote>

<h2 id="toc_1">前端工程简史</h2>

<blockquote>

<p class="md_block">
    <span class="md_line">工程化, 关心的是如何将源码和资源文件发布为产品的过程</span>
</p>

</blockquote>

<h3 id="toc_2">石器时代</h3>

<p class="md_block">
    <span class="md_line">早期的Web页面主要承担<strong>静态内容</strong>的展现，用户交互仅仅限于<strong>提交表单</strong>或者<strong>点击链接</strong>。</span>
</p>


<p class="md_block">
    <span class="md_line">页面内容通常由后台生成，例如在php或jsp中，在页面中<strong>嵌入后台代码</strong>。</span>
</p>


<p class="md_block">
    <span class="md_line">在这个年代, 网页脚本语言的特点是<strong>功能简单, 语法简单, 易学习, 易部署</strong>, Web应用开发是<strong>重服务端, 轻客户端</strong>, 开发人员以后台开发为主, 兼顾浏览器端, 没有所谓的前端工程师.</span>
</p>


<h3 id="toc_3">铜器时代</h3>

<p class="md_block">
    <span class="md_line">比较典型的标志是<strong>组件化</strong>和<strong>异步加载</strong></span>
</p>


<p class="md_block">
    <span class="md_line">以Gmail为代表的Web 2.0时代的到来，大量AJAX技术的应用, 使得页面可以进行<strong>异步请求</strong>和<strong>局部刷新</strong>，能够提供更为丰富的<strong>用户交互</strong>功能，承担了更多的业务逻辑。</span>
</p>


<p class="md_block">
    <span class="md_line">在html中嵌入脚本的方式已经难以处理快速增加的复杂度，独立的业务逻辑被<strong>分割</strong>到单独的js文件中，页面通过<strong>script</strong>标签引入。</span>
</p>


<p class="md_block">
    <span class="md_line">这个时候已经出现了一批专职的前端工程师, 但是受限于<strong>浏览器兼容性</strong>和<strong>浏览器性能</strong>, 前端依然无法承担过多的职责, 前端工程师需要兼职图片处理, 需要掌握Photoshop/Dreamweaver等图形处理工具, 也被称为<strong>切图仔</strong></span>
</p>


<h3 id="toc_4">农业时代</h3>

<p class="md_block">
    <span class="md_line">使用script标签引入脚本时，当脚本之间存在依赖关系，就必须要保证脚本的<strong>加载顺序</strong>，同时，这种方式下所有的内容都是声明在<strong>全局变量</strong>之上，依然难以满足高度复杂的业务需要。</span>
</p>


<p class="md_block">
    <span class="md_line">由于JavaScript自身的先天缺陷，缺少模块化的支持，开发人员通过<strong>命名空间</strong>、<strong>AMD</strong>、<strong>CMD</strong>等模块化方案来分割模块。</span>
</p>


<p class="md_block">
    <span class="md_line">这时出现了RequireJS/SeaJS/browserify等异步加载框架, 在页面中通常需要引入这些开源组件, 处理模块化加载.</span>
</p>


<p class="md_block md_has_block_below md_has_block_below_blockquote">
    <span class="md_line">与此同时, 随着资源文件的增多, 工程化处理过程逐渐复杂, 出现了Grunt/Gulp等工程化构建工具, 帮助开发者自动化处理这些繁琐的操作.</span>
</p>


<blockquote>

<p class="md_block">
    <span class="md_line">http://requirejs.org/<br /></span>
    <span class="md_line">https://seajs.github.io/seajs/docs/#intro<br /></span>
    <span class="md_line">http://browserify.org/<br /></span>
    <span class="md_line">https://gruntjs.com/<br /></span>
    <span class="md_line">https://gulpjs.com/</span>
</p>

</blockquote>

<h3 id="toc_5">工业时代</h3>

<p class="md_block">
    <span class="md_line">伴随着移动互联网的快速发展，前端承担了越来越多的业务应用。为了降低开发难度，合理的控制项目复杂性，各种MV*框架被应用到实际项目中。</span>
</p>


<p class="md_block">
    <span class="md_line">同时，ES6标准的确定、前后端分离的普及、工程化理念的加深，在自动化构建流水线中加入了<strong>预编译、自动化测试、静态代码检查、资源打包等</strong>优秀的开发实践，使得开发人员可以充分利用自动化工具来<strong>简化日常工作、提高工作效率</strong>。</span>
</p>


<p class="md_block md_has_block_below md_has_block_below_img">
    <span class="md_line">比较有代表性的工具是Webpack, 通过其强大的功能和生态体系, 逐渐取代Grunt/Gulp成为当今主流.</span>
</p>

<img onerror="this.src='../../现代前端开发/_image/2018-01-02-23-00-09.jpg';this.onerror=null;"  class="" src="/现代前端开发/_image/2018-01-02-23-00-09.jpg" alt="" title="" >
<blockquote>

<p class="md_block">
    <span class="md_line">http://es6.ruanyifeng.com/<br /></span>
    <span class="md_line">https://doc.webpack-china.org/</span>
</p>

</blockquote>

<h2 id="toc_6">NodeJS</h2>

<p class="md_block md_has_block_below md_has_block_below_blockquote">
    <span class="md_line">前端工程化的发展得益于NodeJS的出现. </span>
</p>


<blockquote>

<p class="md_block">
    <span class="md_line">http://nodejs.cn/<br /></span>
    <span class="md_line">    &gt; Node.js 是一个基于 Chrome V8 引擎的 JavaScript 运行环境。 <br /></span>
    <span class="md_line">    &gt; Node.js 使用了一个事件驱动、非阻塞式 I/O 的模型，使其轻量又高效。 <br /></span>
    <span class="md_line">    &gt; Node.js 的包管理器 npm，是全球最大的开源库生态系统。</span>
</p>

</blockquote>

<p class="md_block">
    <span class="md_line">在此之前, JavaScript的运行环境受限于浏览器环境, 前端工程领域需要借助其他平台的能力, 附属在其他构建工具之下, 例如maven或ant. 不仅功能受限而且对于前端开发人员来说, 难以按自己所需要的方式进行扩展. </span>
</p>


<p class="md_block">
    <span class="md_line">NodeJS带来了服务端运行环境, 相当于JavaScript领域的JDK, 不仅扩大了前端开发人员的工作范围, 也引发了业界的JavaScript学习潮流. </span>
</p>


<p class="md_block md_has_block_below md_has_block_below_img">
    <span class="md_line">更为重要的是NodeJS自身配备的npm包管理器, 极大<strong>丰富了前端开发生态</strong>.</span>
</p>

<img onerror="this.src='../../现代前端开发/_image/2018-01-03-00-03-06.jpg';this.onerror=null;"  class="" src="/现代前端开发/_image/2018-01-03-00-03-06.jpg" alt="" title="" >
<blockquote>

<p class="md_block">
    <span class="md_line">https://www.npmjs.com/</span>
</p>

</blockquote>

<p class="md_block md_has_block_below md_has_block_below_img">
    <span class="md_line">前端开发人员可以根据自己的实际需要, 使用熟悉的语言, 快速开发出适合的工具来加速自己的开发工作.<br /></span>
    <span class="md_line">借助npm提供的开源生态, 可以快速的下载和分享, 并且以此构建出一个强大而且丰富的生态系统.</span>
</p>

<img onerror="this.src='../../现代前端开发/_image/2018-01-03-00-31-51.jpg';this.onerror=null;"  class="" src="/现代前端开发/_image/2018-01-03-00-31-51.jpg" alt="" title="" >
<p class="md_block md_has_block_below md_has_block_below_ul">
    <span class="md_line">通过前端开发工具, 我们可以通过一条简单命令完成: </span>
</p>


<ul>
<li>JavaScript、css文件的混淆和压缩</li>
<li>图片的压缩和雪碧图合并</li>
<li>ES6、Sass/Less的预编译</li>
<li>三方件的依赖管理和瘦身</li>
<li>自动化的静态代码检查、测试执行</li>
<li>自动化打包部署</li>
<li>本地调试时的自动编译和浏览器自动刷新</li>
<li>……</li>
</ul>

<h3 id="toc_7">cnpm</h3>

<p class="md_block md_has_block_below md_has_block_below_blockquote">
    <span class="md_line">由于国内网络环境, 可以安装cnpm或者手动配置为淘宝镜像, 对于网络受限的工作环境下, 也会在公司内部提供私有镜像</span>
</p>


<blockquote>

<p class="md_block">
    <span class="md_line">https://npm.taobao.org/</span>
</p>

</blockquote>
<div class="codehilite code_lang_shell  highlight"><pre><span></span>$ npm install -g cnpm --registry<span class="o">=</span>https://registry.npm.taobao.org
</pre></div>

<!--block_code_end-->
<h2 id="toc_8">前后端分离</h2>

<p class="md_block">
    <span class="md_line">随着客户端需求的不断复杂, 市场对速度的要求越来越高, 传统的大锅饭或兼职开发流程已经无法满足现代市场发展的需要. </span>
</p>


<p class="md_block">
    <span class="md_line">前端领域的快速发展, 也超越了后端工程师的能力范畴, 必须由专业的前端工程师来负责.</span>
</p>


<p class="md_block">
    <span class="md_line"><strong>随着市场的发展, 必然出现专业化分工</strong>, 其理念可以映射到开发领域的<strong>解耦</strong>和<strong>关注点分离</strong></span>
</p>


<p class="md_block md_has_block_below md_has_block_below_blockquote">
    <span class="md_line">明确而合理的分工能够使得开发人员更加<strong>聚焦</strong>于所属领域, 并且能够改善前后端协作过程中的低效环节</span>
</p>


<blockquote>

<p class="md_block">
    <span class="md_line">工程化的目标便是释放生产力, 提高效率</span>
</p>

</blockquote>

<h3 id="toc_9">开发</h3>

<p class="md_block">
    <span class="md_line">开发阶段主要关注<strong>代码组织</strong>和<strong>开发方式</strong>, 目的是提高效率</span>
</p>


<p class="md_block">
    <span class="md_line">在分离之前, 前端代码以<strong>模板</strong>的形式附属在后端项目中, 页面依赖于后端的模板渲染.</span>
</p>


<p class="md_block md_has_block_below md_has_block_below_ul">
    <span class="md_line">这种管理方式的问题在于: </span>
</p>


<ul>
<li>后端项目的构建流程无法满足现代前端开发的需要</li>
<li>前端代码的运行依赖于候选渲染, 无法进行本地化开发</li>
<li>前端代码的提交依赖于后端项目, 无法独立进行问题修复和版本发布</li>
</ul>

<p class="md_block md_has_block_below md_has_block_below_ul">
    <span class="md_line">面对上述的各种问题, 逐渐演化出当前流行的<strong>SPA架构模式</strong>, 在SPA模式下: </span>
</p>


<ul>
<li>不再有模板的概念, 前端从后端获取的只是纯粹的JSON数据, 借助框架完成页面渲染</li>
<li>因为数据的简单和纯粹, 前端代码可以借助本地代理或者Mock服务, 直接在本地运行前端项目</li>
<li>前后端只通过固定的REST接口确定契约, 无直接依赖, 可以使用独立仓库管理, 也可以独立的进行版本发布</li>
</ul>

<p class="md_block md_has_block_below md_has_block_below_ul">
    <span class="md_line">在当前的技术环境下, 通常都会配备完备的本地开发工具链: </span>
</p>


<ul>
<li>脚手架 - 快速初始化项目以及命令行工具</li>
<li>本地构建 - 自动化执行本地构建, 包括预编译/静态检查/单元测试/自动刷新等</li>
<li>代理/Mock - 在本地运行前端项目并连接到云端服务, 或者直接通过Mock服务模拟后端数据接口</li>
</ul>

<h3 id="toc_10">协作</h3>

<p class="md_block">
    <span class="md_line">开发态的构建只是提高了开发人员的<strong>独立工作效率</strong>, 无论如何分离, 都应该牢记, 前后端终归是作为一体化的产品进行发布, 是<strong>协作关系, 而不是对立关系</strong> </span>
</p>


<p class="md_block md_has_block_below md_has_block_below_ul">
    <span class="md_line">协作主要强调与后端的<strong>协作配合</strong>, 减少<strong>联调</strong>阶段的生产效率损耗. 在上述讨论中已经涉及了相关内容: </span>
</p>


<ul>
<li>确定REST接口契约, 前后端独立开发, 避免相互依赖</li>
<li>所谓联调, 之所以存在这个概念, 便是前后端没有明确契约, 导致了相互依赖</li>
<li>产品最终是以用户体验/用户价值为核心, 前端是直接为用户提供能力的领域, 便应该在出现问题的时候站在第一线作为第一责任人</li>
</ul>

<h3 id="toc_11">部署</h3>

<p class="md_block">
    <span class="md_line">前后端分离的部署方面, 应该借鉴当前火热的<strong>微服务编排</strong>理念, 分属不同的功能域便应该独立发布和部署. </span>
</p>


<p class="md_block">
    <span class="md_line">在以往的部署方式中, 前端代码附属于后端项目, 只作为某个业务模块的展现层, 在这种方式下, 当前端需要更新功能或修改问题时, 却要依赖于后端的版本发布, 对前端来说会导致部署流程困难, 对后端来说也是一次无意义的发布. </span>
</p>


<h3 id="toc_12">总结</h3>

<p class="md_block">
    <span class="md_line">分离不是分家, 最终目的都是为了产品能够<strong>更快速/更灵活</strong>的持续交付.</span>
</p>


<p class="md_block">
    <span class="md_line">其核心思想是解耦, 通过这种分离的方式, 各自独立进行开发, 提高各自独立和整体的工作效率.</span>
</p>


<h2 id="toc_13">常见的工程化工具</h2>

<ul>
<li>Grunt - 基于JavaScript的任务管理器，通过配置文件和外置插件，自动进行预编译、混淆压缩、单元测试、项目构建等自动化任务</li>
<li>Gulp - 针对Grunt一次性加载文件，导致构建效率低、系统资源消耗高的缺陷，Glup通过**流**技术将待处理的文件在插件之间传递。</li>
<li>Webpack - 后起之秀却有着一统天下之势，能够把包括脚本文件、样式文件、图片等所有资源都进行加载和处理</li>
</ul>
<img onerror="this.src='../../现代前端开发/_image/2018-01-04-00-03-12.jpg';this.onerror=null;"  class="" src="/现代前端开发/_image/2018-01-04-00-03-12.jpg" alt="" title="" >
<blockquote>

<p class="md_block">
    <span class="md_line">https://insights.stackoverflow.com/trends?tags=gruntjs%2Cgulp%2Cwebpack</span>
</p>

</blockquote>

<h3 id="toc_14">Grunt - http://www.gruntjs.net/</h3>
<img onerror="this.src='../../现代前端开发/_image/2018-01-03-23-20-06.jpg';this.onerror=null;"  class="" src="/现代前端开发/_image/2018-01-03-23-20-06.jpg" alt="" title="" >
<p class="md_block">
    <span class="md_line">Grunt本身并不提供任何具体功能, 只是作为<strong>骨架/平台</strong>, 通过其丰富的<strong>插件系统</strong>实现具体功能. </span>
</p>


<h4 id="toc_15">使用简介</h4>

<blockquote>

<p class="md_block">
    <span class="md_line">http://www.gruntjs.net/getting-started</span>
</p>

</blockquote>

<ul>
<li>首先, 通过npm安装grunt, 作为全局安装或者作为项目中的开发依赖</li>
</ul>
<div class="codehilite code_lang_shell  highlight"><pre><span></span>$ npm install -g grunt-cli

or

$ npm install --save-dev grunt-cli
</pre></div>

<!--block_code_end-->
<ul>
<li>其次, 安装相关依赖, 通过package.json统一管理</li>
</ul>
<div class="codehilite code_lang_js  highlight"><pre><span></span><span class="p">{</span>
  <span class="s2">&quot;name&quot;</span><span class="o">:</span> <span class="s2">&quot;my-project-name&quot;</span><span class="p">,</span>
  <span class="s2">&quot;version&quot;</span><span class="o">:</span> <span class="s2">&quot;0.1.0&quot;</span><span class="p">,</span>
  <span class="s2">&quot;devDependencies&quot;</span><span class="o">:</span> <span class="p">{</span>
    <span class="s2">&quot;grunt&quot;</span><span class="o">:</span> <span class="s2">&quot;~0.4.5&quot;</span><span class="p">,</span>
    <span class="s2">&quot;grunt-contrib-jshint&quot;</span><span class="o">:</span> <span class="s2">&quot;~0.10.0&quot;</span><span class="p">,</span>
    <span class="s2">&quot;grunt-contrib-nodeunit&quot;</span><span class="o">:</span> <span class="s2">&quot;~0.4.1&quot;</span><span class="p">,</span>
    <span class="s2">&quot;grunt-contrib-uglify&quot;</span><span class="o">:</span> <span class="s2">&quot;~0.5.0&quot;</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></div>

<!--block_code_end-->
<ul>
<li>接着, 在项目根目录添加Gruntfile配置文件, 在当中定义各种插件的配置</li>
</ul>
<div class="codehilite code_lang_js  highlight"><pre><span></span><span class="nx">module</span><span class="p">.</span><span class="nx">exports</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">grunt</span><span class="p">)</span> <span class="p">{</span>

  <span class="c1">// Project configuration.</span>
  <span class="nx">grunt</span><span class="p">.</span><span class="nx">initConfig</span><span class="p">({</span>
    <span class="nx">pkg</span><span class="o">:</span> <span class="nx">grunt</span><span class="p">.</span><span class="nx">file</span><span class="p">.</span><span class="nx">readJSON</span><span class="p">(</span><span class="s1">&#39;package.json&#39;</span><span class="p">),</span>
    <span class="nx">uglify</span><span class="o">:</span> <span class="p">{</span>
      <span class="nx">options</span><span class="o">:</span> <span class="p">{</span>
        <span class="nx">banner</span><span class="o">:</span> <span class="s1">&#39;/*! &lt;%= pkg.name %&gt; &lt;%= grunt.template.today(&quot;yyyy-mm-dd&quot;) %&gt; */\n&#39;</span>
      <span class="p">},</span>
      <span class="nx">build</span><span class="o">:</span> <span class="p">{</span>
        <span class="nx">src</span><span class="o">:</span> <span class="s1">&#39;src/&lt;%= pkg.name %&gt;.js&#39;</span><span class="p">,</span>
        <span class="nx">dest</span><span class="o">:</span> <span class="s1">&#39;build/&lt;%= pkg.name %&gt;.min.js&#39;</span>
      <span class="p">}</span>
    <span class="p">}</span>
  <span class="p">});</span>

  <span class="c1">// 加载包含 &quot;uglify&quot; 任务的插件。</span>
  <span class="nx">grunt</span><span class="p">.</span><span class="nx">loadNpmTasks</span><span class="p">(</span><span class="s1">&#39;grunt-contrib-uglify&#39;</span><span class="p">);</span>

  <span class="c1">// 默认被执行的任务列表。</span>
  <span class="nx">grunt</span><span class="p">.</span><span class="nx">registerTask</span><span class="p">(</span><span class="s1">&#39;default&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;uglify&#39;</span><span class="p">]);</span>

<span class="p">};</span>
</pre></div>

<!--block_code_end-->
<ul>
<li>在配置文件中注册执行任务</li>
</ul>
<div class="codehilite code_lang_js  highlight"><pre><span></span><span class="c1">// Default task(s).</span>
<span class="nx">grunt</span><span class="p">.</span><span class="nx">registerTask</span><span class="p">(</span><span class="s1">&#39;default&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;uglify&#39;</span><span class="p">]);</span>
</pre></div>

<!--block_code_end-->
<ul>
<li>最后, 在命令行执行grunt命令执行构建任务</li>
</ul>

<blockquote>

<p class="md_block">
    <span class="md_line">通过定义 default 任务，可以让Grunt默认执行一个或多个任务。在下面的这个案例中，执行 grunt 命令时如果不指定一个任务的话，将会执行uglify任务。这和执行grunt uglify 或者 grunt default的效果一样。default任务列表数组中可以指定任意数目的任务（可以带参数）。</span>
</p>

</blockquote>

<ul>
<li>一个完整的Gruntfile配置文件</li>
</ul>
<div class="codehilite code_lang_js  highlight"><pre><span></span><span class="nx">module</span><span class="p">.</span><span class="nx">exports</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">grunt</span><span class="p">)</span> <span class="p">{</span>

  <span class="nx">grunt</span><span class="p">.</span><span class="nx">initConfig</span><span class="p">({</span>
    <span class="nx">pkg</span><span class="o">:</span> <span class="nx">grunt</span><span class="p">.</span><span class="nx">file</span><span class="p">.</span><span class="nx">readJSON</span><span class="p">(</span><span class="s1">&#39;package.json&#39;</span><span class="p">),</span>
    <span class="nx">concat</span><span class="o">:</span> <span class="p">{</span>
      <span class="nx">options</span><span class="o">:</span> <span class="p">{</span>
        <span class="nx">separator</span><span class="o">:</span> <span class="s1">&#39;;&#39;</span>
      <span class="p">},</span>
      <span class="nx">dist</span><span class="o">:</span> <span class="p">{</span>
        <span class="nx">src</span><span class="o">:</span> <span class="p">[</span><span class="s1">&#39;src/**/*.js&#39;</span><span class="p">],</span>
        <span class="nx">dest</span><span class="o">:</span> <span class="s1">&#39;dist/&lt;%= pkg.name %&gt;.js&#39;</span>
      <span class="p">}</span>
    <span class="p">},</span>
    <span class="nx">uglify</span><span class="o">:</span> <span class="p">{</span>
      <span class="nx">options</span><span class="o">:</span> <span class="p">{</span>
        <span class="nx">banner</span><span class="o">:</span> <span class="s1">&#39;/*! &lt;%= pkg.name %&gt; &lt;%= grunt.template.today(&quot;dd-mm-yyyy&quot;) %&gt; */\n&#39;</span>
      <span class="p">},</span>
      <span class="nx">dist</span><span class="o">:</span> <span class="p">{</span>
        <span class="nx">files</span><span class="o">:</span> <span class="p">{</span>
          <span class="s1">&#39;dist/&lt;%= pkg.name %&gt;.min.js&#39;</span><span class="o">:</span> <span class="p">[</span><span class="s1">&#39;&lt;%= concat.dist.dest %&gt;&#39;</span><span class="p">]</span>
        <span class="p">}</span>
      <span class="p">}</span>
    <span class="p">},</span>
    <span class="nx">qunit</span><span class="o">:</span> <span class="p">{</span>
      <span class="nx">files</span><span class="o">:</span> <span class="p">[</span><span class="s1">&#39;test/**/*.html&#39;</span><span class="p">]</span>
    <span class="p">},</span>
    <span class="nx">jshint</span><span class="o">:</span> <span class="p">{</span>
      <span class="nx">files</span><span class="o">:</span> <span class="p">[</span><span class="s1">&#39;Gruntfile.js&#39;</span><span class="p">,</span> <span class="s1">&#39;src/**/*.js&#39;</span><span class="p">,</span> <span class="s1">&#39;test/**/*.js&#39;</span><span class="p">],</span>
      <span class="nx">options</span><span class="o">:</span> <span class="p">{</span>
        <span class="c1">//这里是覆盖JSHint默认配置的选项</span>
        <span class="nx">globals</span><span class="o">:</span> <span class="p">{</span>
          <span class="nx">jQuery</span><span class="o">:</span> <span class="kc">true</span><span class="p">,</span>
          <span class="nx">console</span><span class="o">:</span> <span class="kc">true</span><span class="p">,</span>
          <span class="nx">module</span><span class="o">:</span> <span class="kc">true</span><span class="p">,</span>
          <span class="nb">document</span><span class="o">:</span> <span class="kc">true</span>
        <span class="p">}</span>
      <span class="p">}</span>
    <span class="p">},</span>
    <span class="nx">watch</span><span class="o">:</span> <span class="p">{</span>
      <span class="nx">files</span><span class="o">:</span> <span class="p">[</span><span class="s1">&#39;&lt;%= jshint.files %&gt;&#39;</span><span class="p">],</span>
      <span class="nx">tasks</span><span class="o">:</span> <span class="p">[</span><span class="s1">&#39;jshint&#39;</span><span class="p">,</span> <span class="s1">&#39;qunit&#39;</span><span class="p">]</span> <span class="c1">// 文件变更时自动执行静态检查和单元测试</span>
    <span class="p">}</span>
  <span class="p">});</span>

  <span class="nx">grunt</span><span class="p">.</span><span class="nx">loadNpmTasks</span><span class="p">(</span><span class="s1">&#39;grunt-contrib-uglify&#39;</span><span class="p">);</span> <span class="c1">// 代码混淆</span>
  <span class="nx">grunt</span><span class="p">.</span><span class="nx">loadNpmTasks</span><span class="p">(</span><span class="s1">&#39;grunt-contrib-jshint&#39;</span><span class="p">);</span> <span class="c1">// 静态检查</span>
  <span class="nx">grunt</span><span class="p">.</span><span class="nx">loadNpmTasks</span><span class="p">(</span><span class="s1">&#39;grunt-contrib-qunit&#39;</span><span class="p">);</span> <span class="c1">// 单元测试</span>
  <span class="nx">grunt</span><span class="p">.</span><span class="nx">loadNpmTasks</span><span class="p">(</span><span class="s1">&#39;grunt-contrib-watch&#39;</span><span class="p">);</span> <span class="c1">// 监听文件变化, 自动执行任务</span>
  <span class="nx">grunt</span><span class="p">.</span><span class="nx">loadNpmTasks</span><span class="p">(</span><span class="s1">&#39;grunt-contrib-concat&#39;</span><span class="p">);</span> <span class="c1">// 文件合并/打包</span>

  <span class="nx">grunt</span><span class="p">.</span><span class="nx">registerTask</span><span class="p">(</span><span class="s1">&#39;test&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;jshint&#39;</span><span class="p">,</span> <span class="s1">&#39;qunit&#39;</span><span class="p">]);</span> 

  <span class="nx">grunt</span><span class="p">.</span><span class="nx">registerTask</span><span class="p">(</span><span class="s1">&#39;default&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;jshint&#39;</span><span class="p">,</span> <span class="s1">&#39;qunit&#39;</span><span class="p">,</span> <span class="s1">&#39;concat&#39;</span><span class="p">,</span> <span class="s1">&#39;uglify&#39;</span><span class="p">]);</span>

<span class="p">};</span>
</pre></div>

<!--block_code_end-->
<h4 id="toc_16">插件系统</h4>

<blockquote>

<p class="md_block">
    <span class="md_line">http://www.gruntjs.net/plugins</span>
</p>

</blockquote>
<img onerror="this.src='../../现代前端开发/_image/2018-01-03-23-33-14.jpg';this.onerror=null;"  class="" src="/现代前端开发/_image/2018-01-03-23-33-14.jpg" alt="" title="" >
<h4 id="toc_17">总结</h4>

<p class="md_block">
    <span class="md_line">Grunt属于比较早期的构建工具, 其设计理念比较老旧, 而且对新技术的支持并不理想, 目前除了遗留系统, 已经很少使用.</span>
</p>


<h3 id="toc_18">Gulp - https://gulpjs.com/</h3>
<img onerror="this.src='../../现代前端开发/_image/2018-01-03-23-57-08.jpg';this.onerror=null;"  class="" src="/现代前端开发/_image/2018-01-03-23-57-08.jpg" alt="" title="" >
<p class="md_block">
    <span class="md_line">与Grunt的定位相似, 其本身只作为一个插件运行平台, 通过其丰富的插件生态系统提供具体的功能. </span>
</p>


<p class="md_block">
    <span class="md_line">其设计理念是针对Grunt工具的主要缺陷: <strong>Grunt是将构建流水线拆分为独立子任务, 在整体构建过程中会产生大量的临时文件</strong>, 而Gulp则基于<strong>流</strong>的概念, 任务之间通过<strong>管道连接</strong>, 不会产生额外开销. </span>
</p>


<p class="md_block">
    <span class="md_line">事实上, Gulp能够取代Grunt的原因在于, 在开源社区文化之下, Gulp提供了更先进的设计理念, 从而吸引来了当时<strong>最好的开源贡献者</strong>, 在社区的贡献之下, 快速构建先进的插件生态, 适配前沿的技术框架, 构建先进的持续构建理念, 进而带来了技术的演进和更迭.</span>
</p>


<h4 id="toc_19">使用简介</h4>

<blockquote>

<p class="md_block">
    <span class="md_line">https://github.com/gulpjs/gulp/blob/master/docs/getting-started.md</span>
</p>

</blockquote>

<ul>
<li>首先, 通过npm进行安装全局的命令行工具和开发依赖</li>
</ul>
<div class="codehilite code_lang_shell  highlight"><pre><span></span>$ npm install -g gulp-cli
$ npm install --save-dev gulp
</pre></div>

<!--block_code_end-->
<ul>
<li>其次, 在项目根目录下新增配置文件gulpfile.js</li>
</ul>
<div class="codehilite code_lang_js  highlight"><pre><span></span><span class="kd">var</span> <span class="nx">gulp</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;gulp&#39;</span><span class="p">);</span>
<span class="kd">var</span> <span class="nx">pug</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;gulp-pug&#39;</span><span class="p">);</span>
<span class="kd">var</span> <span class="nx">less</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;gulp-less&#39;</span><span class="p">);</span>
<span class="kd">var</span> <span class="nx">minifyCSS</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;gulp-csso&#39;</span><span class="p">);</span>

<span class="nx">gulp</span><span class="p">.</span><span class="nx">task</span><span class="p">(</span><span class="s1">&#39;html&#39;</span><span class="p">,</span> <span class="kd">function</span><span class="p">(){</span>
  <span class="k">return</span> <span class="nx">gulp</span><span class="p">.</span><span class="nx">src</span><span class="p">(</span><span class="s1">&#39;client/templates/*.pug&#39;</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">pipe</span><span class="p">(</span><span class="nx">pug</span><span class="p">())</span>
    <span class="p">.</span><span class="nx">pipe</span><span class="p">(</span><span class="nx">gulp</span><span class="p">.</span><span class="nx">dest</span><span class="p">(</span><span class="s1">&#39;build/html&#39;</span><span class="p">))</span>
<span class="p">});</span>

<span class="nx">gulp</span><span class="p">.</span><span class="nx">task</span><span class="p">(</span><span class="s1">&#39;css&#39;</span><span class="p">,</span> <span class="kd">function</span><span class="p">(){</span>
  <span class="k">return</span> <span class="nx">gulp</span><span class="p">.</span><span class="nx">src</span><span class="p">(</span><span class="s1">&#39;client/templates/*.less&#39;</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">pipe</span><span class="p">(</span><span class="nx">less</span><span class="p">())</span>
    <span class="p">.</span><span class="nx">pipe</span><span class="p">(</span><span class="nx">minifyCSS</span><span class="p">())</span>
    <span class="p">.</span><span class="nx">pipe</span><span class="p">(</span><span class="nx">gulp</span><span class="p">.</span><span class="nx">dest</span><span class="p">(</span><span class="s1">&#39;build/css&#39;</span><span class="p">))</span>
<span class="p">});</span>

<span class="nx">gulp</span><span class="p">.</span><span class="nx">task</span><span class="p">(</span><span class="s1">&#39;default&#39;</span><span class="p">,</span> <span class="p">[</span> <span class="s1">&#39;html&#39;</span><span class="p">,</span> <span class="s1">&#39;css&#39;</span> <span class="p">]);</span>
</pre></div>

<!--block_code_end-->
<ul>
<li>接着, 在命令行执行gulp执行构建流程</li>
</ul>
<div class="codehilite code_lang_shell  highlight"><pre><span></span>$ gulp
</pre></div>

<!--block_code_end-->
<h4 id="toc_20">插件系统</h4>

<blockquote>

<p class="md_block">
    <span class="md_line">https://gulpjs.com/plugins/</span>
</p>

</blockquote>
<img onerror="this.src='../../现代前端开发/_image/2018-01-04-00-01-35.jpg';this.onerror=null;"  class="" src="/现代前端开发/_image/2018-01-04-00-01-35.jpg" alt="" title="" >
<h4 id="toc_21">实例 - 基于Gulp构建ES6、Sass应用</h4>

<ul>
<li>构建一个简单的应用, 创建一个定时器，在页面刷新当前事件</li>
</ul>
<img onerror="this.src='../../现代前端开发/_image/2018-01-04-00-04-40.jpg?r=70';this.onerror=null;"  class="" src="/现代前端开发/_image/2018-01-04-00-04-40.jpg" style="width:70%" class="md_scaled_image"  alt="" title="" style="width:70%;"><div class="codehilite code_lang_html  highlight"><pre><span></span><span class="cp">&lt;!DOCTYPE html&gt;</span>
<span class="p">&lt;</span><span class="nt">html</span> <span class="na">lang</span><span class="o">=</span><span class="s">&quot;en&quot;</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">head</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">meta</span> <span class="na">charset</span><span class="o">=</span><span class="s">&quot;UTF-8&quot;</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">title</span><span class="p">&gt;</span>Main<span class="p">&lt;/</span><span class="nt">title</span><span class="p">&gt;</span>

  <span class="p">&lt;</span><span class="nt">link</span> <span class="na">rel</span><span class="o">=</span><span class="s">&quot;stylesheet&quot;</span> <span class="na">href</span><span class="o">=</span><span class="s">&quot;sass/index.scss&quot;</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">head</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">body</span><span class="p">&gt;</span>

  <span class="p">&lt;</span><span class="nt">div</span> <span class="na">id</span><span class="o">=</span><span class="s">&quot;timer&quot;</span><span class="p">&gt;&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>

  <span class="p">&lt;</span><span class="nt">script</span> <span class="na">type</span><span class="o">=</span><span class="s">&quot;text/javascript&quot;</span> <span class="na">src</span><span class="o">=</span><span class="s">&quot;js/timer.js&quot;</span><span class="p">&gt;&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
  <span class="p">&lt;</span><span class="nt">script</span> <span class="na">type</span><span class="o">=</span><span class="s">&quot;text/javascript&quot;</span> <span class="na">src</span><span class="o">=</span><span class="s">&quot;js/index.js&quot;</span><span class="p">&gt;&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">body</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">html</span><span class="p">&gt;</span>
</pre></div>

<!--block_code_end--><div class="codehilite code_lang_js  highlight"><pre><span></span><span class="c1">// index.js</span>
<span class="nb">window</span><span class="p">.</span><span class="nx">onload</span> <span class="o">=</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span> <span class="c1">// 页面载入时执行初始化</span>
    <span class="nx">load</span><span class="p">()</span>
<span class="p">}</span>

<span class="kd">function</span> <span class="nx">load</span><span class="p">()</span> <span class="p">{</span>
  <span class="kr">const</span> <span class="nx">dom</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s1">&#39;timer&#39;</span><span class="p">)</span>
  <span class="kr">const</span> <span class="nx">timer</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Timer</span><span class="p">(</span><span class="nx">dom</span><span class="p">)</span> <span class="c1">// 初始化定时器对象</span>
  <span class="nx">timer</span><span class="p">.</span><span class="nx">render</span><span class="p">()</span>
<span class="p">}</span>
</pre></div>

<!--block_code_end--><div class="codehilite code_lang_js  highlight"><pre><span></span><span class="c1">// timer.js</span>
<span class="kr">class</span> <span class="nx">Timer</span> <span class="p">{</span> 
    <span class="nx">constructor</span><span class="p">(</span><span class="nx">dom</span><span class="p">)</span> <span class="p">{</span> 
        <span class="k">this</span><span class="p">.</span><span class="nx">dom</span> <span class="o">=</span> <span class="nx">dom</span> 
    <span class="p">}</span> 
    <span class="nx">render</span><span class="p">()</span> <span class="p">{</span> 
        <span class="nx">setInterval</span><span class="p">(()</span> <span class="o">=&gt;</span> <span class="p">{</span> 
            <span class="k">this</span><span class="p">.</span><span class="nx">dom</span><span class="p">.</span><span class="nx">textContent</span> <span class="o">=</span> <span class="k">new</span> <span class="nb">Date</span><span class="p">()</span> 
        <span class="p">},</span> <span class="mi">1000</span><span class="p">)</span> 
    <span class="p">}</span> 
<span class="p">}</span>
</pre></div>

<!--block_code_end--><div class="codehilite code_lang_sass  highlight"><pre><span></span><span class="c1">// index.scss</span>
<span class="nn">#timer</span> <span class="err">{</span>
  <span class="na">color</span><span class="o">:</span> <span class="ni">cornflowerblue</span><span class="err">;</span>
  <span class="na">font-size</span><span class="o">:</span> <span class="mi">20</span><span class="kt">px</span><span class="err">;</span>
  <span class="na">font-weight</span><span class="o">:</span> <span class="no">bold</span><span class="err">;</span>
<span class="err">}</span>
</pre></div>

<!--block_code_end-->
<ul>
<li>安装gulp和gulp-cli</li>
</ul>
<div class="codehilite code_lang_shell  highlight"><pre><span></span>$ npm install gulp gulp-cli --save-dev
</pre></div>

<!--block_code_end-->
<ul>
<li>加入静态代码检查，纠正编码风格</li>
</ul>
<div class="codehilite code_lang_shell  highlight"><pre><span></span>$ npm install eslint eslint-cli --save-dev
</pre></div>

<!--block_code_end-->
<ul>
<li>执行eslint命令行, 初始化配置文件.eslintrc</li>
</ul>
<div class="codehilite code_lang_shell  highlight"><pre><span></span>$ eslint --init
</pre></div>

<!--block_code_end--><img onerror="this.src='../../现代前端开发/_image/2018-01-04-00-09-23.jpg?r=100';this.onerror=null;"  class="" src="/现代前端开发/_image/2018-01-04-00-09-23.jpg" style="width:100%" class="md_scaled_image"  alt="" title="" style="width:100%;"><div class="codehilite code_lang_js  highlight"><pre><span></span><span class="nx">module</span><span class="p">.</span><span class="nx">exports</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;env&quot;</span><span class="o">:</span> <span class="p">{</span>
        <span class="s2">&quot;browser&quot;</span><span class="o">:</span> <span class="kc">true</span><span class="p">,</span>
        <span class="s2">&quot;es6&quot;</span><span class="o">:</span> <span class="kc">true</span>
    <span class="p">},</span>
    <span class="s2">&quot;extends&quot;</span><span class="o">:</span> <span class="s2">&quot;eslint:recommended&quot;</span><span class="p">,</span>
    <span class="s2">&quot;parserOptions&quot;</span><span class="o">:</span> <span class="p">{</span>
        <span class="s2">&quot;sourceType&quot;</span><span class="o">:</span> <span class="s2">&quot;module&quot;</span>
    <span class="p">},</span>
    <span class="s2">&quot;rules&quot;</span><span class="o">:</span> <span class="p">{</span>
        <span class="s2">&quot;indent&quot;</span><span class="o">:</span> <span class="p">[</span>
            <span class="s2">&quot;error&quot;</span><span class="p">,</span>
            <span class="mi">4</span>
        <span class="p">],</span>
        <span class="s2">&quot;linebreak-style&quot;</span><span class="o">:</span> <span class="p">[</span>
            <span class="s2">&quot;error&quot;</span><span class="p">,</span>
            <span class="s2">&quot;unix&quot;</span>
        <span class="p">],</span>
        <span class="s2">&quot;quotes&quot;</span><span class="o">:</span> <span class="p">[</span>
            <span class="s2">&quot;error&quot;</span><span class="p">,</span>
            <span class="s2">&quot;single&quot;</span>
        <span class="p">],</span>
        <span class="s2">&quot;semi&quot;</span><span class="o">:</span> <span class="p">[</span>
            <span class="s2">&quot;error&quot;</span><span class="p">,</span>
            <span class="s2">&quot;never&quot;</span>
        <span class="p">]</span>
    <span class="p">}</span>
<span class="p">};</span>
</pre></div>

<!--block_code_end-->
<ul>
<li>安装gulp的eslint插件, 创建gulpfile.js文件，加入eslint任务</li>
</ul>
<div class="codehilite code_lang_shell  highlight"><pre><span></span>$ npm install gulp-eslint --save-dev
</pre></div>

<!--block_code_end--><div class="codehilite code_lang_js  highlight"><pre><span></span><span class="kr">const</span> <span class="nx">eslint</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;gulp-eslint&#39;</span><span class="p">);</span>
<span class="kr">const</span> <span class="nx">gulp</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;gulp&#39;</span><span class="p">);</span>

<span class="nx">gulp</span><span class="p">.</span><span class="nx">task</span><span class="p">(</span><span class="s1">&#39;eslint&#39;</span><span class="p">,</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="nx">gulp</span><span class="p">.</span><span class="nx">src</span><span class="p">(</span><span class="s1">&#39;src/**/*.js&#39;</span><span class="p">)</span>
      <span class="p">.</span><span class="nx">pipe</span><span class="p">(</span><span class="nx">eslint</span><span class="p">({</span>
        <span class="nx">useEslintrc</span><span class="o">:</span> <span class="kc">true</span> <span class="c1">// 使用.eslintrc配置文件</span>
      <span class="p">}))</span>
      <span class="p">.</span><span class="nx">pipe</span><span class="p">(</span><span class="nx">eslint</span><span class="p">.</span><span class="nx">format</span><span class="p">())</span> <span class="c1">// 输出检查结果</span>
      <span class="p">.</span><span class="nx">pipe</span><span class="p">(</span><span class="nx">eslint</span><span class="p">.</span><span class="nx">failAfterError</span><span class="p">();</span> <span class="c1">// 检查失败时，终止任务</span>
<span class="p">});</span>
</pre></div>

<!--block_code_end-->
<ul>
<li>执行gulp task命令执行检查，看似简单的实现却隐藏者众多的缺陷</li>
</ul>
<div class="codehilite code_lang_shell  highlight"><pre><span></span>$ grunt eslint
</pre></div>

<!--block_code_end--><img onerror="this.src='../../现代前端开发/_image/2018-01-04-00-12-10.jpg';this.onerror=null;"  class="" src="/现代前端开发/_image/2018-01-04-00-12-10.jpg" alt="" title="" >
<ul>
<li>类似的步骤，添加sass的静态检查</li>
</ul>

<blockquote>

<p class="md_block">
    <span class="md_line">需要先安装gem：sudo gem install scss_lint</span>
</p>

</blockquote>
<div class="codehilite code_lang_shell  highlight"><pre><span></span>$ npm install gulp-sass-lint --save-dev
</pre></div>

<!--block_code_end--><div class="codehilite code_lang_js  highlight"><pre><span></span><span class="nx">gulp</span><span class="p">.</span><span class="nx">task</span><span class="p">(</span><span class="s1">&#39;scsslint&#39;</span><span class="p">,</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>
  <span class="nx">gulp</span><span class="p">.</span><span class="nx">src</span><span class="p">(</span><span class="s1">&#39;src/**/*.scss&#39;</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">pipe</span><span class="p">(</span><span class="nx">scsslint</span><span class="p">())</span>
    <span class="p">.</span><span class="nx">pipe</span><span class="p">(</span><span class="nx">scsslint</span><span class="p">.</span><span class="nx">failReporter</span><span class="p">());</span>
<span class="p">});</span>
</pre></div>

<!--block_code_end--><img onerror="this.src='../../现代前端开发/_image/2018-01-04-00-13-48.jpg';this.onerror=null;"  class="" src="/现代前端开发/_image/2018-01-04-00-13-48.jpg" alt="" title="" >
<ul>
<li>使用babel编译js文件</li>
</ul>

<blockquote>

<p class="md_block">
    <span class="md_line">http://babeljs.io/docs/setup#installation</span>
</p>

</blockquote>
<div class="codehilite code_lang_shell  highlight"><pre><span></span>$ npm install babel babel-cli gulp-babel babel-preset-env --save-dev
</pre></div>

<!--block_code_end--><div class="codehilite code_lang_js  highlight"><pre><span></span><span class="nx">gulp</span><span class="p">.</span><span class="nx">task</span><span class="p">(</span><span class="s1">&#39;compile-js&#39;</span><span class="p">,</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="nx">gulp</span><span class="p">.</span><span class="nx">src</span><span class="p">(</span><span class="s1">&#39;src/**/*.js&#39;</span><span class="p">)</span>
      <span class="p">.</span><span class="nx">pipe</span><span class="p">(</span><span class="nx">babel</span><span class="p">({</span>
        <span class="nx">presets</span><span class="o">:</span> <span class="p">[</span><span class="s1">&#39;env&#39;</span><span class="p">]</span> <span class="c1">// 使用es6插件集编译</span>
      <span class="p">}))</span>
      <span class="p">.</span><span class="nx">pipe</span><span class="p">(</span><span class="nx">gulp</span><span class="p">.</span><span class="nx">dest</span><span class="p">(</span><span class="s1">&#39;dist/js&#39;</span><span class="p">));</span> <span class="c1">// 编译后的文件输出到dist</span>
<span class="p">});</span>
</pre></div>

<!--block_code_end--><img onerror="this.src='../../现代前端开发/_image/2018-01-04-00-17-01.jpg';this.onerror=null;"  class="" src="/现代前端开发/_image/2018-01-04-00-17-01.jpg" alt="" title="" ><img onerror="this.src='../../现代前端开发/_image/2018-01-04-00-17-20.jpg';this.onerror=null;"  class="" src="/现代前端开发/_image/2018-01-04-00-17-20.jpg" alt="" title="" >
<ul>
<li>编译scss文件</li>
</ul>
<div class="codehilite code_lang_shell  highlight"><pre><span></span>$ npm install gulp-sass --save-dev
</pre></div>

<!--block_code_end--><div class="codehilite code_lang_js  highlight"><pre><span></span><span class="nx">gulp</span><span class="p">.</span><span class="nx">task</span><span class="p">(</span><span class="s1">&#39;compile-scss&#39;</span><span class="p">,</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>
  <span class="nx">gulp</span><span class="p">.</span><span class="nx">src</span><span class="p">(</span><span class="s1">&#39;src/**/*.scss&#39;</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">pipe</span><span class="p">(</span><span class="nx">sass</span><span class="p">().</span><span class="nx">on</span><span class="p">(</span><span class="s1">&#39;error&#39;</span><span class="p">,</span> <span class="nx">sass</span><span class="p">.</span><span class="nx">logError</span><span class="p">))</span>
    <span class="p">.</span><span class="nx">pipe</span><span class="p">(</span><span class="nx">gulp</span><span class="p">.</span><span class="nx">dest</span><span class="p">(</span><span class="s1">&#39;dist/css&#39;</span><span class="p">));</span> <span class="c1">// 编译后的文件输出到dist</span>
<span class="p">});</span>
</pre></div>

<!--block_code_end-->
<ul>
<li>代码合并、压缩、重命名</li>
</ul>
<div class="codehilite code_lang_shell  highlight"><pre><span></span>$ npm install gulp-concat gulp-uglify gulp-clean-css gulp-rename --save-dev
</pre></div>

<!--block_code_end--><div class="codehilite code_lang_js  highlight"><pre><span></span><span class="nx">gulp</span><span class="p">.</span><span class="nx">task</span><span class="p">(</span><span class="s1">&#39;concat&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;compile-js&#39;</span><span class="p">,</span> <span class="s1">&#39;compile-scss&#39;</span><span class="p">],</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>
  <span class="nx">gulp</span><span class="p">.</span><span class="nx">src</span><span class="p">(</span><span class="s1">&#39;dist/css/**/*.css&#39;</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">pipe</span><span class="p">(</span><span class="nx">concat</span><span class="p">(</span><span class="s1">&#39;style.css&#39;</span><span class="p">))</span>
    <span class="p">.</span><span class="nx">pipe</span><span class="p">(</span><span class="nx">gulp</span><span class="p">.</span><span class="nx">dest</span><span class="p">(</span><span class="s1">&#39;dist/latest&#39;</span><span class="p">))</span>
  <span class="nx">gulp</span><span class="p">.</span><span class="nx">src</span><span class="p">(</span><span class="s1">&#39;dist/js/**/*.js&#39;</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">pipe</span><span class="p">(</span><span class="nx">concat</span><span class="p">(</span><span class="s1">&#39;app.js&#39;</span><span class="p">))</span>
    <span class="p">.</span><span class="nx">pipe</span><span class="p">(</span><span class="nx">gulp</span><span class="p">.</span><span class="nx">dest</span><span class="p">(</span><span class="s1">&#39;dist/latest&#39;</span><span class="p">))</span>
<span class="p">})</span>

<span class="nx">gulp</span><span class="p">.</span><span class="nx">task</span><span class="p">(</span><span class="s1">&#39;minify&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;concat&#39;</span><span class="p">],</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>
  <span class="nx">gulp</span><span class="p">.</span><span class="nx">src</span><span class="p">(</span><span class="s1">&#39;dist/latest/app.js&#39;</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">pipe</span><span class="p">(</span><span class="nx">uglify</span><span class="p">())</span>
    <span class="p">.</span><span class="nx">pipe</span><span class="p">(</span><span class="nx">rename</span><span class="p">((</span><span class="nx">path</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
        <span class="k">return</span> <span class="nx">path</span><span class="p">.</span><span class="nx">basename</span> <span class="o">+=</span> <span class="s1">&#39;.min&#39;</span>
    <span class="p">}))</span>
    <span class="p">.</span><span class="nx">pipe</span><span class="p">(</span><span class="nx">gulp</span><span class="p">.</span><span class="nx">dest</span><span class="p">(</span><span class="s1">&#39;dist/latest&#39;</span><span class="p">))</span>
  <span class="nx">gulp</span><span class="p">.</span><span class="nx">src</span><span class="p">(</span><span class="s1">&#39;dist/latest/style.css&#39;</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">pipe</span><span class="p">(</span><span class="nx">cleanCSS</span><span class="p">())</span>
    <span class="p">.</span><span class="nx">pipe</span><span class="p">(</span><span class="nx">rename</span><span class="p">((</span><span class="nx">path</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
      <span class="k">return</span> <span class="nx">path</span><span class="p">.</span><span class="nx">basename</span> <span class="o">+=</span> <span class="s1">&#39;.min&#39;</span>
    <span class="p">}))</span>
    <span class="p">.</span><span class="nx">pipe</span><span class="p">(</span><span class="nx">gulp</span><span class="p">.</span><span class="nx">dest</span><span class="p">(</span><span class="s1">&#39;dist/latest&#39;</span><span class="p">))</span>
<span class="p">})</span>
</pre></div>

<!--block_code_end-->
<ul>
<li>监听文件变化, 当文件变更时，重新生成文件</li>
</ul>
<div class="codehilite code_lang_js  highlight"><pre><span></span><span class="nx">gulp</span><span class="p">.</span><span class="nx">task</span><span class="p">(</span><span class="s1">&#39;watch&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;concat&#39;</span><span class="p">],</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="nx">gulp</span><span class="p">.</span><span class="nx">watch</span><span class="p">([</span><span class="s1">&#39;src/**/*.js&#39;</span><span class="p">,</span> <span class="s1">&#39;src/**/*.scss&#39;</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;concat&#39;</span><span class="p">]);</span>
<span class="p">});</span>
</pre></div>

<!--block_code_end-->
<ul>
<li>替换html中的url引用</li>
</ul>
<div class="codehilite code_lang_shell  highlight"><pre><span></span>$ npm install gulp-html-replace --save-dev
</pre></div>

<!--block_code_end-->
<p class="md_block md_has_block_below md_has_block_below_img">
    <span class="md_line">在html文件中，通过注释配置替换块</span>
</p>

<img onerror="this.src='../../现代前端开发/_image/2018-01-04-00-20-13.jpg';this.onerror=null;"  class="" src="/现代前端开发/_image/2018-01-04-00-20-13.jpg" alt="" title="" ><div class="codehilite code_lang_js  highlight"><pre><span></span><span class="nx">gulp</span><span class="p">.</span><span class="nx">task</span><span class="p">(</span><span class="s1">&#39;html-replace&#39;</span><span class="p">,</span><span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
  <span class="k">return</span> <span class="nx">gulp</span><span class="p">.</span><span class="nx">src</span><span class="p">(</span><span class="s1">&#39;./src/*.html&#39;</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">pipe</span><span class="p">(</span><span class="nx">htmlreplace</span><span class="p">({</span>
      <span class="s1">&#39;css&#39;</span><span class="o">:</span> <span class="s1">&#39;style.min.css&#39;</span><span class="p">,</span>
      <span class="s1">&#39;js&#39;</span><span class="o">:</span> <span class="s1">&#39;app.min.js&#39;</span>
    <span class="p">}))</span>
    <span class="p">.</span><span class="nx">pipe</span><span class="p">(</span><span class="nx">gulp</span><span class="p">.</span><span class="nx">dest</span><span class="p">(</span><span class="s1">&#39;./dist/latest&#39;</span><span class="p">));</span>
<span class="p">});</span>
</pre></div>

<!--block_code_end-->
<p class="md_block md_has_block_below md_has_block_below_img">
    <span class="md_line">执行替换后的html文件：</span>
</p>

<img onerror="this.src='../../现代前端开发/_image/2018-01-04-00-20-56.jpg';this.onerror=null;"  class="" src="/现代前端开发/_image/2018-01-04-00-20-56.jpg" alt="" title="" >
<ul>
<li>在开发状态下, 文件变化后，自动刷新浏览器</li>
</ul>
<div class="codehilite code_lang_shell  highlight"><pre><span></span>$ npm install browser-sync --save-dev
</pre></div>

<!--block_code_end--><div class="codehilite code_lang_js  highlight"><pre><span></span><span class="nx">gulp</span><span class="p">.</span><span class="nx">task</span><span class="p">(</span><span class="s1">&#39;watch&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;concat&#39;</span><span class="p">,</span> <span class="s1">&#39;minify&#39;</span><span class="p">,</span> <span class="s1">&#39;html-replace&#39;</span><span class="p">],</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="nx">gulp</span><span class="p">.</span><span class="nx">watch</span><span class="p">([</span><span class="s1">&#39;src/**/*.js&#39;</span><span class="p">,</span> <span class="s1">&#39;src/**/*.scss&#39;</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;concat&#39;</span><span class="p">,</span> <span class="s1">&#39;minify&#39;</span><span class="p">,</span> <span class="s1">&#39;html-replace&#39;</span><span class="p">])</span>
<span class="p">});</span>

<span class="nx">gulp</span><span class="p">.</span><span class="nx">task</span><span class="p">(</span><span class="s1">&#39;browser-sync&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;watch&#39;</span><span class="p">],</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="nx">browserSync</span><span class="p">({</span>
      <span class="nx">server</span><span class="o">:</span> <span class="s1">&#39;dist/latest&#39;</span>
    <span class="p">})</span>
<span class="p">});</span>
</pre></div>

<!--block_code_end-->
<h4 id="toc_22">总结</h4>

<p class="md_block md_has_block_below md_has_block_below_ul">
    <span class="md_line">可以看到, 借助Gulp强大的插件生态, 可以构建完整的工程体系: </span>
</p>


<ul>
<li>ES6/Sass预编译</li>
<li>代码的混淆压缩</li>
<li>本地文件监听和自动刷新</li>
<li>文件打包和引用注入</li>
</ul>

<p class="md_block md_has_block_below md_has_block_below_ul">
    <span class="md_line">其他可能还包括:</span>
</p>


<ul>
<li>图片压缩</li>
<li>雪碧图合并</li>
<li>小图片转码为base64</li>
<li>后端接口的Mock服务或代理</li>
<li>... ...</li>
</ul>

<h3 id="toc_23">Webpack - https://webpack.js.org/</h3>
<img onerror="this.src='../../现代前端开发/_image/2018-01-04-00-27-07.jpg';this.onerror=null;"  class="" src="/现代前端开发/_image/2018-01-04-00-27-07.jpg" alt="" title="" >
<p class="md_block">
    <span class="md_line">这里只做简单介绍, 后续会有完整的分享</span>
</p>


<h4 id="toc_24">使用webpack构建一个React应用</h4>

<ul>
<li>安装相关依赖</li>
</ul>
<div class="codehilite code_lang_shell  highlight"><pre><span></span>$ yarn add react react-dom
$ yarn add babel-core babel-loader babel-preset-latest babel-preset-react webpack webpack-dev-server --dev
</pre></div>

<!--block_code_end--><img onerror="this.src='../../现代前端开发/_image/2018-01-04-00-28-26.jpg';this.onerror=null;"  class="" src="/现代前端开发/_image/2018-01-04-00-28-26.jpg" alt="" title="" >
<ul>
<li>简单实现页面功能</li>
</ul>
<div class="codehilite code_lang_html  highlight"><pre><span></span><span class="cp">&lt;!DOCTYPE html&gt;</span>
<span class="p">&lt;</span><span class="nt">html</span> <span class="na">lang</span><span class="o">=</span><span class="s">&quot;en&quot;</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">head</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">meta</span> <span class="na">charset</span><span class="o">=</span><span class="s">&quot;UTF-8&quot;</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">title</span><span class="p">&gt;</span>Webpack Demo<span class="p">&lt;/</span><span class="nt">title</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">head</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">body</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">div</span> <span class="na">id</span><span class="o">=</span><span class="s">&quot;root&quot;</span><span class="p">&gt;&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>

    <span class="p">&lt;</span><span class="nt">script</span> <span class="na">src</span><span class="o">=</span><span class="s">&quot;./bundle.js&quot;</span><span class="p">&gt;&lt;/</span><span class="nt">script</span><span class="p">&gt;</span> <span class="c">&lt;!-- 引用打包后的文件 --&gt;</span>
<span class="p">&lt;/</span><span class="nt">body</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">html</span><span class="p">&gt;</span>
</pre></div>

<!--block_code_end--><div class="codehilite code_lang_js  highlight"><pre><span></span><span class="kr">import</span> <span class="nx">React</span><span class="p">,</span> <span class="p">{</span><span class="nx">Component</span><span class="p">}</span> <span class="nx">from</span> <span class="s1">&#39;react&#39;</span>
<span class="kr">import</span> <span class="nx">ReactDom</span> <span class="nx">from</span> <span class="s1">&#39;react-dom&#39;</span>
<span class="kr">import</span> <span class="nx">Hello</span> <span class="nx">from</span> <span class="s1">&#39;./hello&#39;</span>

<span class="kr">class</span> <span class="nx">App</span> <span class="kr">extends</span> <span class="nx">Component</span> <span class="p">{</span>
    <span class="nx">render</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">return</span> <span class="p">(</span>
            <span class="o">&lt;</span><span class="nx">div</span><span class="o">&gt;</span>
                <span class="nx">Hello</span> <span class="nx">Webpack</span><span class="o">!</span>
            <span class="o">&lt;</span><span class="err">/div&gt;</span>
        <span class="p">)</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="nx">ReactDom</span><span class="p">.</span><span class="nx">render</span><span class="p">(</span><span class="o">&lt;</span><span class="nx">App</span> <span class="o">/&gt;</span><span class="p">,</span> <span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s1">&#39;root&#39;</span><span class="p">))</span>
</pre></div>

<!--block_code_end-->
<ul>
<li>创建配置文件webpack.conf.js</li>
</ul>
<div class="codehilite code_lang_js  highlight"><pre><span></span><span class="kr">const</span> <span class="nx">webpack</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;webpack&#39;</span><span class="p">)</span>

<span class="nx">module</span><span class="p">.</span><span class="nx">exports</span> <span class="o">=</span> <span class="p">{</span>
    <span class="nx">entry</span><span class="o">:</span> <span class="nx">__dirname</span> <span class="o">+</span> <span class="s1">&#39;/app/index.js&#39;</span><span class="p">,</span> <span class="c1">// 入口文件</span>
    <span class="nx">output</span><span class="o">:</span> <span class="p">{</span>
        <span class="nx">path</span><span class="o">:</span> <span class="nx">__dirname</span> <span class="o">+</span> <span class="s1">&#39;/public&#39;</span><span class="p">,</span> <span class="c1">// 输出路径</span>
        <span class="nx">filename</span><span class="o">:</span> <span class="s1">&#39;bundle.js&#39;</span> <span class="c1">// 打包文件名</span>
    <span class="p">},</span>
    <span class="nx">module</span><span class="o">:</span> <span class="p">{</span>
        <span class="nx">rules</span><span class="o">:</span> <span class="p">[</span>
            <span class="p">{</span>
                <span class="nx">test</span><span class="o">:</span> <span class="sr">/\.js$/</span><span class="p">,</span>
                <span class="nx">exclude</span><span class="o">:</span> <span class="sr">/(node_modules|bower_components)/</span><span class="p">,</span>
                <span class="nx">use</span><span class="o">:</span> <span class="p">{</span>
                    <span class="nx">loader</span><span class="o">:</span> <span class="s1">&#39;babel-loader&#39;</span><span class="p">,</span>
                    <span class="nx">options</span><span class="o">:</span> <span class="p">{</span>
                        <span class="nx">presets</span><span class="o">:</span> <span class="p">[</span><span class="s1">&#39;es2015&#39;</span><span class="p">,</span> <span class="s1">&#39;react&#39;</span><span class="p">]</span>
                    <span class="p">}</span>
                <span class="p">}</span>
            <span class="p">}</span>
        <span class="p">]</span>
    <span class="p">},</span>
    <span class="nx">devServer</span><span class="o">:</span> <span class="p">{</span>
        <span class="nx">contentBase</span><span class="o">:</span> <span class="s1">&#39;./public&#39;</span><span class="p">,</span>
        <span class="nx">inline</span><span class="o">:</span> <span class="kc">true</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>

<!--block_code_end-->
<ul>
<li>执行webpack-dev-server执行编译和加载</li>
</ul>
<img onerror="this.src='../../现代前端开发/_image/2018-01-04-00-30-22.jpg';this.onerror=null;"  class="" src="/现代前端开发/_image/2018-01-04-00-30-22.jpg" alt="" title="" >
<h3 id="toc_25">Rollup - https://rollupjs.org/</h3>
<img onerror="this.src='../../现代前端开发/_image/2018-01-04-00-31-33.jpg';this.onerror=null;"  class="" src="/现代前端开发/_image/2018-01-04-00-31-33.jpg" alt="" title="" >
<blockquote>

<p class="md_block">
    <span class="md_line">Rollup 是一个 JavaScript 模块打包器，可以将小块代码编译成大块复杂的代码，例如 library 或应用程序。Rollup 对代码模块使用新的标准化格式，这些标准都包含在 JavaScript 的 ES6 版本中，而不是以前的特殊解决方案，如 CommonJS 和 AMD。ES6 模块可以使你自由、无缝地使用你最喜爱的 library 中那些最有用独立函数，而你的项目不必携带其他未使用的代码。ES6 模块最终还是要由浏览器原生实现，但当前 Rollup 可以使你提前体验。</span>
</p>

</blockquote>

<p class="md_block md_has_block_below md_has_block_below_ul">
    <span class="md_line">Rollup的优势在于: </span>
</p>


<ul>
<li>对ES6语法的原生兼容</li>
<li>Tree-shaking技术减少构建结果的体积</li>
<li>构建速度更快</li>
<li>适合npm库的打包</li>
</ul>

<p class="md_block md_has_block_below md_has_block_below_blockquote">
    <span class="md_line">Rollup是目前相对较新的工具, 生态尚不成熟, 是Webapck的有力挑战者, 目前Facebook已经将React的构建过程切换到了Rollup, 但是整体市场占有率上依然以Webpack为主</span>
</p>


<blockquote>

<p class="md_block">
    <span class="md_line">http://www.ayqy.net/blog/%E4%BB%8Ewebpack%E5%88%B0rollup/</span>
</p>

</blockquote>

<h3 id="toc_26">脚手架</h3>

<p class="md_block">
    <span class="md_line">脚手架一词来源于<strong>建筑行业</strong>, 用于辅助工程建设的<strong>临时性</strong>设施, 只作用与<strong>开发环境</strong>, 其作用是为了<strong>提高效率</strong>, 并且<strong>减少人为失误</strong></span>
</p>


<p class="md_block">
    <span class="md_line">其功能是<strong>创建初始文件</strong>, 本质上是对方案的<strong>封装</strong></span>
</p>


<p class="md_block">
    <span class="md_line">脚手架在实际项目中, 通常需要投入人力进行<strong>定制化</strong>开发, 以适配团队整体的构建和发布流程. 是否进行额外的投入要取决于<strong>投入/产出比</strong>, 即投入的人力成本是否能够超越脚手架工具带来的效率提升.</span>
</p>


<h4 id="toc_27">脚手架的功能特性</h4>

<ul>
<li>从功能角度来说

<ul>
<li>快速生成初始化项目/文件</li>
<li>管理项目依赖</li>
</ul></li>
<li>从平台角度考虑

<ul>
<li>具备动态可配置性</li>
<li>底层高度可扩展</li>
</ul></li>
<li>从易用性角度

<ul>
<li>丰富但不繁琐的配置</li>
<li>支持多种运行环境</li>
<li>兼容各种主流操作系统</li>
</ul></li>
</ul>

<h4 id="toc_28">主流的脚手架</h4>

<ul>
<li>create-react-app - Facebook官方提供的脚手架, 底层封装了webpack和Babel, 集成了开发/测试/生产环境的构建, 帮助开发者快速开始React应用</li>
</ul>

<blockquote>

<p class="md_block">
    <span class="md_line">https://github.com/facebookincubator/create-react-app</span>
</p>

</blockquote>
<div class="codehilite code_lang_shell  highlight"><pre><span></span>$ npm install -g create-react-app
$ create-react-app my-app
$ <span class="nb">cd</span> my-app
$ npm start
</pre></div>

<!--block_code_end-->
<ul>
<li>@angular/cli - Angular组件配套的脚手架工具, 底层封装了webpack和TypeScript, 帮助开发者快速构建Angular应用</li>
</ul>

<blockquote>

<p class="md_block">
    <span class="md_line">https://github.com/angular/angular-cli</span>
</p>

</blockquote>
<div class="codehilite code_lang_shell  highlight"><pre><span></span>$ npm install -g @angular/cli
$ ng new PROJECT-NAME
$ <span class="nb">cd</span> PROJECT-NAME
$ ng serve
</pre></div>

<!--block_code_end-->
<p class="md_block">
    <span class="md_line">同时, 它还支持丰富的组件生成功能: </span>
</p>


<pre><code>ng generate component my-new-component
ng g component my-new-component # using the alias

# components support relative path generation
# if in the directory src/app/feature/ and you run
ng g component new-cmp
# your component will be generated in src/app/feature/new-cmp
# but if you were to run
ng g component ../newer-cmp
# your component will be generated in src/app/newer-cmp
# if in the directory src/app you can also run
ng g component feature/new-cmp
# and your component will be generated in src/app/feature/new-cmp</code></pre>

<!--block_code_end-->
<ul>
<li>vue-cli - Vue.js的配套脚手架, 提供了多种风格的项目模板</li>
</ul>

<blockquote>

<p class="md_block">
    <span class="md_line">https://github.com/vuejs/vue-cli</span>
</p>

</blockquote>
<div class="codehilite code_lang_shell  highlight"><pre><span></span>$ npm install -g vue-cli
$ vue init &lt;template-name&gt; &lt;project-name&gt;
</pre></div>

<!--block_code_end--><img onerror="this.src='../../现代前端开发/_image/2018-01-04-23-30-48.jpg';this.onerror=null;"  class="" src="/现代前端开发/_image/2018-01-04-23-30-48.jpg" alt="" title="" >
<ul>
<li>dva-cli - 配套阿里dva框架的脚手架, dva内部集成了React/React Router/Saga/Webpack等主流框架, 同时与AntDesign一脉相承, 具备更好的兼容性</li>
</ul>

<blockquote>

<p class="md_block">
    <span class="md_line">https://github.com/dvajs/dva-cli</span>
</p>

</blockquote>
<div class="codehilite code_lang_shell  highlight"><pre><span></span><span class="c1"># Install</span>
$ npm install dva-cli -g

<span class="c1"># Create app</span>
$ dva new myapp

<span class="c1"># Start app</span>
$ <span class="nb">cd</span> myapp
$ npm start
</pre></div>

<!--block_code_end-->
<p class="md_block">
    <span class="md_line">同时也提供了组件生成工具: </span>
</p>

<div class="codehilite code_lang_shell  highlight"><pre><span></span>$ dva g route product-list
$ dva g model products
$ dva g component Editor
$ dva g component Users/UserModal
$ dva g component Header --no-css
</pre></div>

<!--block_code_end-->
<ul>
<li>yeoman - 原意是自由民/自耕农, 具备丰富的生态环境和强大的自定义构建能力.</li>
</ul>

<blockquote>

<p class="md_block">
    <span class="md_line">http://yeoman.io/</span>
</p>

</blockquote>
<div class="codehilite code_lang_shell  highlight"><pre><span></span>$ npm install -g yo <span class="c1"># 安装yeoman</span>
$ npm install -g generator-webapp <span class="c1"># 安装生成器</span>
$ yo webapp <span class="c1"># 初始化项目</span>
</pre></div>

<!--block_code_end-->
<blockquote>

<p class="md_block">
    <span class="md_line">简单教程: http://yeoman.io/codelab/index.html<br /></span>
    <span class="md_line">生成器市场: http://yeoman.io/generators/<br /></span>
    <span class="md_line">自定义生成器: http://yeoman.io/authoring/</span>
</p>

</blockquote>

<ul>
<li>Github上的开源模板, 例如: https://github.com/chentsulin/electron-react-boilerplate</li>
</ul>
<img onerror="this.src='../../现代前端开发/_image/2018-01-04-23-43-08.jpg';this.onerror=null;"  class="" src="/现代前端开发/_image/2018-01-04-23-43-08.jpg" alt="" title="" >
<ul>
<li>基于NodeJS自定义的脚手架</li>
</ul>

<blockquote>

<p class="md_block">
    <span class="md_line">http://www.ruanyifeng.com/blog/2015/05/command-line-with-node.html<br /></span>
    <span class="md_line">https://developer.atlassian.com/blog/2015/11/scripting-with-node/<br /></span>
    <span class="md_line">https://scotch.io/tutorials/build-an-interactive-command-line-application-with-nodejs</span>
</p>

</blockquote>

<ul>
<li>初始化项目</li>
</ul>
<div class="codehilite code_lang_shell  highlight"><pre><span></span>$ npm init
</pre></div>

<!--block_code_end-->
<ul>
<li>创建脚本文件</li>
</ul>
<div class="codehilite code_lang_js  highlight"><pre><span></span><span class="c1">// bin/hello.js</span>
<span class="err">#</span><span class="o">!</span><span class="err">/usr/bin/env node</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;hello world&#39;</span><span class="p">);</span>
</pre></div>

<!--block_code_end-->
<ul>
<li>修改package.json文件, 在bin中绑定脚本命令</li>
</ul>
<div class="codehilite code_lang_js  highlight"><pre><span></span><span class="c1">// package.json</span>

<span class="p">{</span>
  <span class="s2">&quot;name&quot;</span><span class="o">:</span> <span class="s2">&quot;hello&quot;</span><span class="p">,</span>
  <span class="s2">&quot;bin&quot;</span><span class="o">:</span> <span class="p">{</span>
    <span class="s2">&quot;hello&quot;</span><span class="o">:</span> <span class="s2">&quot;bin/hello&quot;</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></div>

<!--block_code_end-->
<ul>
<li>绑定到全局运行环境, 可以作为普通应用执行</li>
</ul>
<div class="codehilite code_lang_shell  highlight"><pre><span></span>$ npm link
$ hello
hello world
</pre></div>

<!--block_code_end-->
<ul>
<li>同样, 工具可以发布到npm仓库, 或者通过git仓库地址分享给他人</li>
</ul>

<h2 id="toc_29">前端工程化的三个阶段</h2>

<h3 id="toc_30">本地工具链 - 工程化不等于工具化</h3>

<p class="md_block md_has_block_below md_has_block_below_ul">
    <span class="md_line">工程化的核心并非工具, 它是以<strong>规范工作流</strong>为手段, 以<strong>工具</strong>作为实现媒介, 其最终目的是为了<strong>提高研发效率</strong>以保证<strong>产品的交付和质量</strong>, 包括:</span>
</p>


<ul>
<li>项目文件的组织结构</li>
<li>源代码的开发范式</li>
<li>工具的使用规范</li>
<li>各阶段环境的依赖</li>
<li>... ...</li>
</ul>

<h3 id="toc_31">管理平台 - 进一步淡化差异, 加深规范</h3>

<p class="md_block">
    <span class="md_line">本地工具链在一定程度上解决了开发过程中的痛点问题, 但是也会因<strong>环境差异导致构建结果的不一致</strong>, 以及<strong>发布流程中的权限</strong>问题. </span>
</p>


<p class="md_block">
    <span class="md_line">在规模较大的产品中, 会构建<strong>统一的云端构建平台</strong>, 以此来淡化环境差异性, 集中进行权限管理和版本控制.</span>
</p>


<h3 id="toc_32">持续集成 - 前端工程化的目的是融入整体</h3>

<p class="md_block">
    <span class="md_line">前端工程化无论如何独立或解耦, 但是最根本的原则上, 它只是整体产品工作流中的一个子集, 最终的完美形态必然与整体工作流结合, 作为持续集成方案中的一环.</span>
</p>


<h2 id="toc_33">构建</h2>

<p class="md_block">
    <span class="md_line">构建是前端工程中最繁琐, 最复杂的模块, 承担着从源码到可执行代码的<strong>转换者</strong>角色.</span>
</p>


<p class="md_block md_has_block_below md_has_block_below_ul">
    <span class="md_line">构建过程通常包括: </span>
</p>


<ul>
<li>编译 - 将ES6/7语法或Sass/Less等高级语法翻译为浏览器可执行的语法</li>
<li>依赖打包 - 基于ES6的模块化方案, 分析模块依赖, 打包为单一文件以减少HTTP请求数</li>
<li>资源嵌入 - 将小图片转换为base64编码, 嵌入到页面中, 减少HTTP请求</li>
<li>文件压缩 - 减小文件体积, 缩短请求时间</li>
<li>hash指纹 - 应对缓存策略, 只更新变更内容, 减少客户端刷新负担</li>
<li>... ...</li>
</ul>

<h2 id="toc_34">本地开发服务器</h2>

<p class="md_block">
    <span class="md_line">本地开发服务器的作用范围是在开发阶段, 主要面向开发者提高开发效率. </span>
</p>


<p class="md_block md_has_block_below md_has_block_below_ul">
    <span class="md_line">主要的方式是对<strong>源码进行监听</strong>, 自动完成开发中的动态构建; 另外一个方面是提供<strong>Mock服务器</strong>, </span>
</p>


<ul>
<li>动态构建 - 分为**懒加载模式**和**实时模式**, 其原理都是: <strong>监听 - 构建</strong>

<ul>
<li>实时模式 - 文件保存后即时触发构建</li>
<li>懒加载模式 - 文件保存时不会触发构建, 而是由浏览器请求触发</li>
</ul></li>
<li>Mock服务 - 部分前端功能开发需要依赖后端接口实现, 这就需要前后端确定契约, 并且通过Mock服务来模拟后端服务, 提高开发效率. Mock的集中常见方式: 

<ul>
<li>假数据 - 通过手动编写一个常量代替接口返回, 缺点是: 开发完成后需要**手动移除**, 而且无法模拟**异常场景**</li>
<li>客户端Mock - 在客户端引用开源Mock组件来创建假数据, 虽然解决了异常处理问题, 但是mock代码依然存在于项目中, 需要在最后是手动删除</li>
<li>服务端Mock - 在服务端通过工具提供Mock服务, 业务代码使用与真实接口类似的**本地接口**请求数据, 在**构建**的时候将其替换到真实的服务器地址, 包括两种实现方式

<ul>
<li>local - 使用本地JSON数据</li>
<li>Proxy - 接口代理到线上的其他地址</li>
</ul></li>
</ul></li>
</ul>

<blockquote>

<p class="md_block">
    <span class="md_line">https://github.com/typicode/json-server<br /></span>
    <span class="md_line">https://webpack.js.org/guides/development/</span>
</p>

</blockquote>

<h2 id="toc_35">工作流</h2>

<p class="md_block md_has_block_below md_has_block_below_img">
    <span class="md_line">与后端开发类似, 前端领域随着近些年的发展已经形成比较完整的工程体系, 也形成了初步成熟的工作流程. </span>
</p>

<img onerror="this.src='../../现代前端开发/_image/Untitled Diagram.png';this.onerror=null;"  class="" src="/现代前端开发/_image/Untitled Diagram.png" alt="" title="" >
<h2 id="toc_36">附录1: Angular项目中的webpack流程</h2>
<img onerror="this.src='../../现代前端开发/_image/2018-01-05-00-36-57.jpg';this.onerror=null;"  class="" src="/现代前端开发/_image/2018-01-05-00-36-57.jpg" alt="" title="" > </div>
                </div>
            </div>

        </div>

    </div>

</div>


<script type="text/javascript" src="../asset/gitbook/app.js"></script>

<script>require(["gitbook"], function (gitbook) {
    var config = {"fontSettings": {"theme": null, "family": "sans", "size": 2}};
    gitbook.start(config);
});

</script>





</body>

</html>